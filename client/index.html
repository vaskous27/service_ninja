<html ng-app="serviceninja">
<head>
  <title>Service Ninjas</title>
  <linke rel="stylesheet" href="http://getbootstrap.com/dist/css/bootstrap.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
  <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.1.0/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-route.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular-moment/0.9.0/angular-moment.min.js"></script>
  <script src="https://rawgit.com/dwmkerr/angular-modal-service/master/dst/angular-modal-service.js"></script>
  <!-- <link href="/stylesdashboard.css" rel="stylesheet"> -->
  <link href="/stylesservice.css" rel="stylesheet">
  <script>
      $(document).ready(function() {
          $('select').material_select();
          });
  	  var serviceninja = angular.module('serviceninja', ['ngRoute', 'angularMoment']);
//factories
    serviceninja.factory('serviceFactory', function($http){
      var factory = {};
      var currentService = {};
      var services = [];
      factory.index = function(callback){
        $http.get('/services').success(function(output){
          services = output;
          callback(output);
        })
      }
      factory.create = function(newService, callback){
        $http.post('/services', newService).success(function(output){
          currentService = output;
          callback(output);
        })
      }
      factory.find = function(id, callback){
        $http.get('/services/' + id).success(function(output){
          callback(output);
        })
      }
      return factory;
    })
    serviceninja.factory('categoryFactory', function($http){
      var factory = {};
      var categories = [];
      factory.index = function(callback){
        $http.get('/categories').success(function(output){
          categories = output;
          callback(output);
        })
      }
      return factory;
    })
    serviceninja.factory('messageFactory', function($http){
      var factory = {};
      factory.create = function(newMessage, callback){
        $http.post('/messages', newMessage).success(function(output){
          callback(output);
        })
      }
      return factory;
    })
//routes
      serviceninja.config(function ($routeProvider) {
          $routeProvider
            .when('/login', {
                templateUrl: 'partials/login.html'
            })
            .when('/signup', {
                templateUrl: 'partials/signup.html'
            })
            .when('/dashboard', {
                templateUrl: 'partials/dashboard.html'
            })            
             .when('/profile', {
                templateUrl: 'partials/profileView.html'
            })
             .when('/form', {
                templateUrl: 'partials/profileForm.html'
            })
            .when('/message', {
                templateUrl: 'partials/message.html'
            })         
            .when('/services',{
                templateUrl: 'partials/servicePartial.html',
                controller: 'serviceController'
            })
            .when('/',{
                templateUrl: 'partials/servicePartial.html',
                controller: 'serviceController'
            })
            .when('/addServices',{
                templateUrl: 'partials/addServicePartial.html',
                controller: 'addServiceController'
            })
            .when('/show/:param1',{
                templateUrl: 'partials/showPartial.html',
                controller: 'showController'
            })
          })                   
//controllers
      serviceninja.controller('FrontController', function($scope){
      
      });
      serviceninja.controller('serviceController', function($scope, serviceFactory, categoryFactory){
        $scope.services = {};
        serviceFactory.index(function(data){
          $scope.services = data;
        })
        categoryFactory.index(function(data){
          $scope.categories = data;
        })
        console.log($scope.services);
      });
      serviceninja.controller('addServiceController', function($scope, serviceFactory, categoryFactory){
        $scope.addService = function(){
          $scope.newService.status = "inactive";
          console.log($scope.newService);
          serviceFactory.create($scope.newService, function(data){
            console.log(data);
          })
        }
        categoryFactory.index(function(data){
          $scope.categories = data;
        })
      });
      serviceninja.controller('showController', function($scope, serviceFactory, $routeParams, messageFactory){
        $scope.currentService = {};
          serviceFactory.find($routeParams.param1, function(data){
          $scope.currentService = data;
          console.log($scope.currentService);
        })
          $scope.addMessage = function(){
            console.log($scope.newMessage);
            messageFactory.create($scope.newMessage, function(data){
              console.log(data);
            })
          }
  });
  </script>
</head>
<body>
<div class="navbar-fixed">
  <nav>
    <div class="nav-wrapper cyan darken-4">
      <a href="#/" class="brand-logo grey-text text-lighten-3">Service Ninja</a>
      <ul id="nav-mobile" class="right hide-on-med-and-down cyan darken-4 grey-text text-lighten-3">
        <li><a href="#/services">Home</a></li>
        <li><a href="#/services">View All Services</a></li>
      </ul>
    </div>
  </nav>
</div>
    <div ng-view="">
    </div>
</body>
</html>
